---
layout: post
title: UI5
---

# Installation

# General Information

## Browser Support

## Security Information

# Development

## Coding Guidelines

* [JavaScript Coding Guidelines](http://vesapui5.dhcp.wdf.sap.corp:1080/trac/sapui5/wiki/InternalDocumentation/DevelopmentGuidelines/JavaScript)
* [Code Review Results](http://vesapui5.dhcp.wdf.sap.corp:1080/trac/sapui5/wiki/InternalDocumentation/DevelopmentGuidelines/CodeReviewResults)

## Initializing & Loading

### Bootstrapping

[Bootstrap](http://vesapui5.dhcp.wdf.sap.corp:1080/trac/sapui5/wiki/Documentation/AdvancedTopics/Bootstrap)

* sap-ui-core.js - jQuery, jquery-ui-position, minimal UI5 core
* sap-ui-core-nojQuery.js - minimal UI5 core
* sap-ui-core-all.js - single js file for each library
* sap-ui5.js - all-in-one file that contains all JS modules from the core, commons, table and ux3 libraries.

The `<script>` tag inside `<head>`:

    <script
        id="sap-ui-bootstrap"
        src="resources/sap-ui-core-all.js"
        data-sap-ui-noConflict="true"
        data-sap-ui-theme="sap_goldreflection
        data-sap-ui-libs="sap.ui.commons">
    </script>


### Configuration

## Control API

## Data Binding

    // JSON sample data
    var data = {
        firstName: "John",
        lastName: "Doe",
        birthday: {day: 01, month: 05, year: 1982},
        address: [{city: "Heidelberg"}],
        enabled: true
    };

    // create JSON model instance
    var model = new sap.ui.model.json.JSONModel();
    // set the data for the model
    model.setData(data);
    // set the model to the core
    sap.ui.getCore().setModel(model);

### Context

CHANGE in VERSION 1.5.1 (MAY 2012): Databinding syntax changed, so that absolute bindings now must have a leading slash. For compatibility reasons, method `setLegacySyntax()` can be used to enable the old binding syntax.

Absolute path - with a leading slash

    var id = model.getProperty("/id");

Relative path - no leading slash and with a context instance:

    var context = new sap.ui.model.Context(model, "/users/0");
    var id = model.getProperty("id", context);

### Data Type

### Validation

## MVC

### Concept

### Fragments

Fragments are pieces of UI - just like SAPUI5 MVC Views, but without the View Control around the content and without their own Controller.

Fragments are light-weight UI parts (UI sub-trees) which can be re-used, defined similar to Views, but do not have any controller or other behavior code involved. They support re-use and View modularization without adding overhead.

Fragments are defined (like Views) within a separate File. The file name ends with `*.fragment.*`.

`ui/fragment/SampleUiPart.fragment.xml`:

    <Panel xmlns="sap.ui.commons">
        <Button id="btnInFragment" text="Hello World" press="doSomething"></Button>
    </Panel>

Instantiating XML Fragments programmatically:

    var panel = sap.ui.xmlfragment("ui.fragment.SampleUiPart"); // this specific fragment does not need a Controller.

Instantiating Fragments in declarative Views:

    <mvc:View controllerName="ui.view.FragmentSample"
        xmlns="sap.ui.commons"
        xmlns:core="sap.ui.core"
        xmlns:mvc="sap.ui.core.mvc"
        xmlns:layout="sap.ui.layout"
        xmlns:form="sap.ui.layout.form">
        <core:Fragment id="fragment1" fragmentName="ui.fragment.SampleUiPart" type="XML" />
    </mvc:View>

One important  difference to Views is that Fragments are no Controls. Views *contain* their content Controls, Fragments *consist* of their content Controls.

And ID can be optionally given. If no ID is given, any Control IDs specified in the Fragment are used as-is. If a Fragment is used several times this can lead to duplicated IDs. One way to avoid that problem is to specify a Fragment ID. This ID will then be used as prefix for all Controls in this Fragment instance.

#### Dialogs as Fragments

Fragments are suited to declaratively define Dialogs and other Popup controls which are not part of the normal page UI structure. This is a huge advantage over Views which do not support this usage (basically because the View Control is always a wrapper around the View content).

To use Fragments for defining popups, just let the root Control of the Fragment be a Dialog or similar control.

#### Unique IDs

Fragments are meant to be a more light-weight concept of separating and re-using UI parts. Therefore static IDs in Fragments are by default used as-is, i.e. they are NOT prefixed to make them unique. But when a Fragment is supposed to be used serveral times within one application, the prefixing mechanism can still be used, by giving and ID when instantiating the Fragment.

When the Fragment is NOT part of a View:

    var control = sap.ui.core.Fragment.byId("myFrag", "myControl");

When the Fragment is embedded into a View and the code is inside a Controller:

    var control = this.byId(sap.ui.core.Fragment.createId("myFrag", "myControl"));

### Model Inheritance

    init: function(isStandalone) {
        if (isStandalone) {
            this.initModel();
        }

        this.initBinding();
        this.initSubView();
    }

## Localization

* Java message bundle \*.properties
* Switch locales by setting different resource bundles.
* Cannot support parameters well.

    var format = {style: "medium"}; // "short", "medium", "long", "full"
    var locale = new sap.ui.core.Locale("en-US");
    var dateFormat = sap.ui.core.format.DateFormat.getDateTimeInstance(format, locale);
    var str = dateFormat.format(new Date());

Date time formats in v1.8.7:

    || Format || en-US || en-GB || zh-CN || zh-TW ||
    | dateFormat-full | Tuesday, January 15, 2013 | Tuesday, 15 January 2013 | 2013年1月15日星期二 | 2013年1月15日星期二 |
    | dateFormat-long | January 15, 2013 | 15 January 2013 | 2013年1月15日 | 2013年1月15日 |
    | dateFormat-medium | Jan 15, 2013 | 15 Jan 2013 | 2013-1-15 | 2013/1/15 |
    | dateFormat-short | 1/15/13 | 15/01/2013 | 13-1-15 | 13/1/15 |
    | timeFormat-full | 7:09:08 PM GMT+08:00 | 19:09:08 GMT+08:00 | GMT+08:00下午7时09分08秒 | GMT+08:00下午7時09分08秒 |
    | timeFormat-long | 7:09:08 PM GMT+08:00 | 19:09:08 GMT+08:00 | GMT+08:00下午7时09分08秒 | GMT+08:00下午7時09分08秒 |
    | timeFormat-medium | 7:09:08 PM | 19:09:08 | 下午7:09:08 | 下午7:09:08 |
    | timeFormat-short | 7:09 PM | 19:09 | 下午7:09 | 下午7:09 |
    | dateTimeFormat-full | Tuesday, January 15, 2013 7:09:08 PM GMT+08:00 | Tuesday, 15 January 2013 19:09:08 GMT+08:00 | 2013年1月15日星期二GMT+08:00下午7时09分08秒 | 2013年1月15日星期二GMT+08:00下午7時09分08秒 |
    | dateTimeFormat-long | January 15, 2013 7:09:08 PM GMT+08:00 | 15 January 2013 19:09:08 GMT+08:00 | 2013年1月15日GMT+08:00下午7时09分08秒 | 2013年1月15日GMT+08:00下午7時09分08秒 |
    | dateTimeFormat-medium | Jan 15, 2013 7:09:08 PM | 15 Jan 2013 19:09:08 | 2013-1-15 下午7:09:08 | 2013/1/15 下午7:09:08 |
    | dateTimeFormat-short | 1/15/13 7:09 PM | 15/01/2013 19:09 | 13-1-15 下午7:09 | 13/1/15 下午7:09 |



## Control Development

[File structure of SAPUI5 UI libraries](http://vesapui5.dhcp.wdf.sap.corp:1080/trac/sapui5/wiki/Documentation/AdvancedTopics/FileStructure)

The specific fold structure:

    src/main/uilib
        |-- <library-folder>
            |-- themes
                |-- base                // one 'theme' that can be loaded at runtime... base is mandatory
                    |-- library.css
                |-- sap_goldreflection
                    |-- library.css
                |-- sap_hcb
                    |-- library.css
            |-- library.js
            |-- shared.js               // containing 'shared' javascript like datatypes etc.
            |-- <Control>.js            // containing the control API and implementation
            |-- <Control>Renderer.js    // containing the renderer for the control
    src/test/uilib
        |-- test-resources
            |-- <libraryName>
                |-- <Control>.html


## Modularization

[Modularization and Dependency Management](http://vesapui5.dhcp.wdf.sap.corp:1080/trac/sapui5/wiki/Documentation/AdvancedTopics/ModularizationConcept)

## Resource Handling

### Client-Side Mechanism

### Server-Side Mechanism

#### Resource Servlet

    <!-- ============================================================== -->
    <!-- SAPUI5 resource servlet used to handle application resources   -->
    <!-- ============================================================== -->

    <servlet>
        <display-name>ResourceServlet</display-name>
        <servlet-name>ResourceServlet</servlet-name>
        <servlet-class>com.sap.ui5.resource.ResourceServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>ResourceServlet</servlet-name>
        <url-pattern>/resources/*</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>ResourceServlet</servlet-name>
        <url-pattern>/test-resources/*</url-pattern>
    </servlet-mapping>

##### Configuration

The Resource Handler is configured via context parameter which are defined in the web.xml.

* `com.sap.ui5.resource.USE_CACHE` - flag to enable resource cache or not (default: "true")
* `com.sap.ui5.resource.MAX_AGE` - max age of resources in millis (default: "604800000" - 1 week)
* `com.sap.ui5.resource.ACCEPTED_ORIGINS` - list of accepted origins, e.g. \* or \*sap.corp,vesapui5.dhcp.wdf.sap.corp (default: empty)
* `com.sap.ui5.resource.DEV_MODE` - flag to enable the development mode (default: "false")
* `com.sap.ui5.resource.TEMPLATE_PATH` - template for the resource listing (default: "/templates/listing.html")
* `com.sap.ui5.resource.VERBOSE` - verbosity of the resource handler (default: "false")
* `com.sap.ui5.resource.REMOTE_LOCATION` - remote location which is used to proxy requests to for resources not being located locally (default: empty)
* `com.sap.ui5.resource.PREFER_REMOTE_LOCATION` - flag to prefer resolving the resource from the remote location before fallback to the classpath (default: false)

##### Development Mode

When starting to develop SAPUI5 controls and modules being located inside the servlet paths resources/ or test-resources/ it makes simplifies this development process by disabling the caching of such resources as well as enabling the resource browsing. To activate the development mode you need to add the following context parameter.

    <!-- BEGIN: DEV MODE -->
    <context-param>
        <param-name>com.sap.ui5.resource.DEV_MODE</param-name>
        <param-value>true</param-value>
    </context-param>
    <!-- END: DEV MODE -->


## Cache Buster

A **Cache Buster** allows the application to notify the browser to refresh the resources only when the application resources have been changed. Otherwise the resources can always be fetched from the browser's cache.


## Theming


## Popup

### Hide in XML view


### DOM location

sap.ui.core.Popup - popups are placed in a static area.

    var core = sap.ui.core.getCore();
    var staticAreaRef = core.getStaticAreaRef();
    var $staticArea = jQuery(staticAreaRef);
    var $popups = $staticArea.children("class~=['sapUiUx3TP']");

### Dock, Position


# Testing

[Testing Environment](http://vesapui5.dhcp.wdf.sap.corp:1080/trac/sapui5/wiki/InternalDocumentation/TestingEnvironment)

## Selenium

[UI5 Control Wrapper for Selenium Application Testing](http://vesapui5.dhcp.wdf.sap.corp:1080/trac/sapui5/wiki/InternalDocumentation/TestingEnvironment/SeleniumWrapper)

[Selenium WebDriver Automation Framework](https://wiki.wdf.sap.corp/wiki/display/ECFQE/Selenium+WebDriver+Automation+Framework)

## QUnit

[How to Setup QUnit](http://vesapui5.dhcp.wdf.sap.corp:1080/trac/sapui5/wiki/InternalDocumentation/TestingEnvironment/HowToSetupQUnit)

UI5 implemented a bridge JSUnit to QUnit which is responsible to collect the status information of the QUnit tests and report them back into the JSUnit framework.

[QUnit Testing](http://vesapui5.dhcp.wdf.sap.corp:1080/trac/sapui5/wiki/Documentation/AdvancedTopics/QUnit)

#### Why does UI5 use Qunit tests?

QUnit tests have been proven to provide a much better support for asynchronous testing in comparision to JSUnit. These kind of tests are often needed for UI functional tests (e.g. wait until rendering is done, some animations complete or a backend call returns) but are complicated to create via JSUnit and are error-prone.

A QUnit test page can be executed standalone in the browser without the need of an additional "tool" like the JSUnit Testrunner. This eases the creation and execution of single QUnit tests.

Finally QUnit is closely related to jQuery (which is also included in UI5).

#### Why does UI5 use JSUnit Testrunner?

The JSUnit Testrunner can be easily integrated into the Maven build (Lean DI) environment to execute our JavaScript unit tests each build. The result of the Testrunner execution finally creates a report in the Maven surefire format which can be used for reporting purposes of a Hudson build server or a Sonar quality system or at least cause a Maven build to break. Also the JSUnit Testrunner is not using any JS shell (e.g. like Jasmine which is using Rhino) furthermore it opens a browser as a process with a parameter containing the site to load and finally waits until the browser submits the results to the Testrunner server. Another interesting usage of the JSUnit Testrunner is that you can cluster your tests in testsuites.

[How To Write A QUnit Test](http://vesapui5.dhcp.wdf.sap.corp:1080/trac/sapui5/wiki/InternalDocumentation/TestingEnvironment/QUnitHowToWriteQUnitTest)

## Build Integration

Inside the POM we use the antrunner plugin to execute the JSUnit TestRunner but beforehand we deploy the jsunit-tests and the jsunit-testrunner war files into a Jetty container. Afterwards it opens a browser with a specific URL and waits until the test has been executed and the result has been submitted to JSUnit server. Now the result will be converted into the Maven surefire format (JUnit). This result can be used e.g. in the Hudson build and display.
